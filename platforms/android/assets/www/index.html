<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1,maximum-scale=1, minimum-scale=1">
    <title>MJ webapp</title>    

  </head>
  <body onload="onLoad()">
    <div id="app">
        
    </div>
    <script src="./dist/build.js"></script>
    <script type="text/javascript" src='cordova.js'></script>
     
    <script type="text/javascript">

    
     function onLoad() {

	    document.addEventListener("deviceready", onDeviceReady, false);
	}

	// 设备API可以使用了
	
	function onDeviceReady() {

  		document.addEventListener("backbutton", onBackKeyDown, false);    

        function onBackKeyDown() { 

			console.log(AppStore.state.pageName,AppStore.state)			
        	if(AppStore.state.pageName == "index"){

	        	 window.plugins.toast.showWithOptions({

				      message: "在点击一次退出啊",
				       duration: "short",
				      position: "bottom",
				      addPixelsY: -200  
				    });
	        	//window.plugins.toast.showShortBottom('再点击一次退出!');  
	        	document.removeEventListener("backbutton", onBackKeyDown, false); //注销返回键  
				document.addEventListener("backbutton", exitApp, false);//绑定退出事件
				//2秒后重新注册  
				var intervalID = window.setInterval(function() {  
					window.clearInterval(intervalID);  
					document.removeEventListener("backbutton", exitApp, false); // 注销返回键  
					document.addEventListener("backbutton", onBackKeyDown, false); //返回键  
				},2000);  

	        }else{
	        	router.go(-1);

	        }
        }  
        function exitApp(){  
            navigator.app.exitApp();  
        } 
	    

        cordova.plugins.notification.local.schedule({
            title:'惊人！如此的厉害！！',
            text: '欢迎你来到我的app,随便看随便看',
            icon:"file://dist/icon.png"
        });
        cordova.plugins.notification.local.on("click", function (notification) {
            alert("竟然你想看看,那就赶紧来吧")
            console.log(notification)
        });
	}
    </script>

  </body>
</html>
